2024-08-17 00:26:21,939   INFO  **********************Start logging**********************
2024-08-17 00:26:21,939   INFO  CUDA_VISIBLE_DEVICES=0,1,2,3,4,5,6,7
2024-08-17 00:26:21,939   INFO  Training in distributed mode : total_batch_size: 16
2024-08-17 00:26:21,940   INFO  cfg_file         cfgs/nuscenes_models/bevfusion.yaml
2024-08-17 00:26:21,940   INFO  batch_size       2
2024-08-17 00:26:21,940   INFO  epochs           20
2024-08-17 00:26:21,940   INFO  workers          4
2024-08-17 00:26:21,940   INFO  extra_tag        bevfusion_baseline_1_4_split_scenes
2024-08-17 00:26:21,940   INFO  ckpt             None
2024-08-17 00:26:21,940   INFO  pretrained_model None
2024-08-17 00:26:21,940   INFO  launcher         pytorch
2024-08-17 00:26:21,940   INFO  tcp_port         18888
2024-08-17 00:26:21,940   INFO  sync_bn          False
2024-08-17 00:26:21,940   INFO  fix_random_seed  False
2024-08-17 00:26:21,941   INFO  ckpt_save_interval 1
2024-08-17 00:26:21,941   INFO  local_rank       0
2024-08-17 00:26:21,941   INFO  max_ckpt_save_num 30
2024-08-17 00:26:21,941   INFO  merge_all_iters_to_one_epoch False
2024-08-17 00:26:21,941   INFO  set_cfgs         None
2024-08-17 00:26:21,941   INFO  max_waiting_mins 0
2024-08-17 00:26:21,941   INFO  start_epoch      0
2024-08-17 00:26:21,941   INFO  num_epochs_to_eval 5
2024-08-17 00:26:21,941   INFO  save_to_file     True
2024-08-17 00:26:21,941   INFO  use_tqdm_to_record False
2024-08-17 00:26:21,941   INFO  logger_iter_interval 50
2024-08-17 00:26:21,941   INFO  ckpt_save_time_interval 300
2024-08-17 00:26:21,942   INFO  wo_gpu_stat      False
2024-08-17 00:26:21,942   INFO  use_amp          False
2024-08-17 00:26:21,942   INFO  split            1.0
2024-08-17 00:26:21,942   INFO  cfg.ROOT_DIR: /home/songziying/workspace/OpenPCDet
2024-08-17 00:26:21,942   INFO  cfg.LOCAL_RANK: 0
2024-08-17 00:26:21,942   INFO  cfg.CLASS_NAMES: ['car', 'truck', 'construction_vehicle', 'bus', 'trailer', 'barrier', 'motorcycle', 'bicycle', 'pedestrian', 'traffic_cone']
2024-08-17 00:26:21,942   INFO  ----------- DATA_CONFIG -----------
2024-08-17 00:26:21,942   INFO  cfg.DATA_CONFIG.DATASET: NuScenesDataset
2024-08-17 00:26:21,942   INFO  cfg.DATA_CONFIG.DATA_PATH: ../data/nuscenes
2024-08-17 00:26:21,942   INFO  cfg.DATA_CONFIG.VERSION: v1.0-trainval
2024-08-17 00:26:21,942   INFO  cfg.DATA_CONFIG.MAX_SWEEPS: 10
2024-08-17 00:26:21,943   INFO  cfg.DATA_CONFIG.PRED_VELOCITY: True
2024-08-17 00:26:21,943   INFO  cfg.DATA_CONFIG.SET_NAN_VELOCITY_TO_ZEROS: True
2024-08-17 00:26:21,943   INFO  cfg.DATA_CONFIG.FILTER_MIN_POINTS_IN_GT: 1
2024-08-17 00:26:21,943   INFO  ----------- DATA_SPLIT -----------
2024-08-17 00:26:21,943   INFO  cfg.DATA_CONFIG.DATA_SPLIT.train: train
2024-08-17 00:26:21,943   INFO  cfg.DATA_CONFIG.DATA_SPLIT.test: val
2024-08-17 00:26:21,943   INFO  ----------- INFO_PATH -----------
2024-08-17 00:26:21,943   INFO  cfg.DATA_CONFIG.INFO_PATH.train: ['nuscenes_infos_10sweeps_1_4_train.pkl']
2024-08-17 00:26:21,943   INFO  cfg.DATA_CONFIG.INFO_PATH.test: ['nuscenes_infos_10sweeps_val.pkl']
2024-08-17 00:26:21,943   INFO  cfg.DATA_CONFIG.POINT_CLOUD_RANGE: [-54.0, -54.0, -5.0, 54.0, 54.0, 3.0]
2024-08-17 00:26:21,943   INFO  cfg.DATA_CONFIG.BALANCED_RESAMPLING: True
2024-08-17 00:26:21,943   INFO  ----------- DATA_AUGMENTOR -----------
2024-08-17 00:26:21,944   INFO  cfg.DATA_CONFIG.DATA_AUGMENTOR.DISABLE_AUG_LIST: ['placeholder']
2024-08-17 00:26:21,944   INFO  cfg.DATA_CONFIG.DATA_AUGMENTOR.AUG_CONFIG_LIST: [{'NAME': 'random_world_flip', 'ALONG_AXIS_LIST': ['x', 'y']}, {'NAME': 'random_world_rotation', 'WORLD_ROT_ANGLE': [-0.78539816, 0.78539816]}, {'NAME': 'random_world_scaling', 'WORLD_SCALE_RANGE': [0.9, 1.1]}, {'NAME': 'random_world_translation', 'NOISE_TRANSLATE_STD': [0.5, 0.5, 0.5]}, {'NAME': 'imgaug', 'ROT_LIM': [-5.4, 5.4], 'RAND_FLIP': True}]
2024-08-17 00:26:21,944   INFO  ----------- POINT_FEATURE_ENCODING -----------
2024-08-17 00:26:21,944   INFO  cfg.DATA_CONFIG.POINT_FEATURE_ENCODING.encoding_type: absolute_coordinates_encoding
2024-08-17 00:26:21,944   INFO  cfg.DATA_CONFIG.POINT_FEATURE_ENCODING.used_feature_list: ['x', 'y', 'z', 'intensity', 'timestamp']
2024-08-17 00:26:21,944   INFO  cfg.DATA_CONFIG.POINT_FEATURE_ENCODING.src_feature_list: ['x', 'y', 'z', 'intensity', 'timestamp']
2024-08-17 00:26:21,944   INFO  cfg.DATA_CONFIG.DATA_PROCESSOR: [{'NAME': 'mask_points_and_boxes_outside_range', 'REMOVE_OUTSIDE_BOXES': True}, {'NAME': 'shuffle_points', 'SHUFFLE_ENABLED': {'train': True, 'test': True}}, {'NAME': 'transform_points_to_voxels', 'VOXEL_SIZE': [0.075, 0.075, 0.2], 'MAX_POINTS_PER_VOXEL': 10, 'MAX_NUMBER_OF_VOXELS': {'train': 120000, 'test': 160000}}, {'NAME': 'image_calibrate'}, {'NAME': 'image_normalize', 'mean': [0.485, 0.456, 0.406], 'std': [0.229, 0.224, 0.225]}]
2024-08-17 00:26:21,944   INFO  cfg.DATA_CONFIG._BASE_CONFIG_: cfgs/dataset_configs/nuscenes_dataset.yaml
2024-08-17 00:26:21,944   INFO  ----------- CAMERA_CONFIG -----------
2024-08-17 00:26:21,944   INFO  cfg.DATA_CONFIG.CAMERA_CONFIG.USE_CAMERA: True
2024-08-17 00:26:21,945   INFO  ----------- IMAGE -----------
2024-08-17 00:26:21,945   INFO  cfg.DATA_CONFIG.CAMERA_CONFIG.IMAGE.FINAL_DIM: [256, 704]
2024-08-17 00:26:21,945   INFO  cfg.DATA_CONFIG.CAMERA_CONFIG.IMAGE.RESIZE_LIM_TRAIN: [0.38, 0.55]
2024-08-17 00:26:21,945   INFO  cfg.DATA_CONFIG.CAMERA_CONFIG.IMAGE.RESIZE_LIM_TEST: [0.48, 0.48]
2024-08-17 00:26:21,945   INFO  ----------- MODEL -----------
2024-08-17 00:26:21,945   INFO  cfg.MODEL.NAME: BevFusion
2024-08-17 00:26:21,945   INFO  ----------- VFE -----------
2024-08-17 00:26:21,945   INFO  cfg.MODEL.VFE.NAME: MeanVFE
2024-08-17 00:26:21,945   INFO  ----------- BACKBONE_3D -----------
2024-08-17 00:26:21,945   INFO  cfg.MODEL.BACKBONE_3D.NAME: VoxelResBackBone8x
2024-08-17 00:26:21,945   INFO  cfg.MODEL.BACKBONE_3D.USE_BIAS: False
2024-08-17 00:26:21,946   INFO  ----------- MAP_TO_BEV -----------
2024-08-17 00:26:21,946   INFO  cfg.MODEL.MAP_TO_BEV.NAME: HeightCompression
2024-08-17 00:26:21,946   INFO  cfg.MODEL.MAP_TO_BEV.NUM_BEV_FEATURES: 256
2024-08-17 00:26:21,946   INFO  ----------- IMAGE_BACKBONE -----------
2024-08-17 00:26:21,946   INFO  cfg.MODEL.IMAGE_BACKBONE.NAME: SwinTransformer
2024-08-17 00:26:21,946   INFO  cfg.MODEL.IMAGE_BACKBONE.EMBED_DIMS: 96
2024-08-17 00:26:21,946   INFO  cfg.MODEL.IMAGE_BACKBONE.DEPTHS: [2, 2, 6, 2]
2024-08-17 00:26:21,946   INFO  cfg.MODEL.IMAGE_BACKBONE.NUM_HEADS: [3, 6, 12, 24]
2024-08-17 00:26:21,946   INFO  cfg.MODEL.IMAGE_BACKBONE.WINDOW_SIZE: 7
2024-08-17 00:26:21,946   INFO  cfg.MODEL.IMAGE_BACKBONE.MLP_RATIO: 4
2024-08-17 00:26:21,946   INFO  cfg.MODEL.IMAGE_BACKBONE.DROP_RATE: 0.0
2024-08-17 00:26:21,946   INFO  cfg.MODEL.IMAGE_BACKBONE.ATTN_DROP_RATE: 0.0
2024-08-17 00:26:21,946   INFO  cfg.MODEL.IMAGE_BACKBONE.DROP_PATH_RATE: 0.2
2024-08-17 00:26:21,946   INFO  cfg.MODEL.IMAGE_BACKBONE.PATCH_NORM: True
2024-08-17 00:26:21,946   INFO  cfg.MODEL.IMAGE_BACKBONE.OUT_INDICES: [1, 2, 3]
2024-08-17 00:26:21,946   INFO  cfg.MODEL.IMAGE_BACKBONE.WITH_CP: False
2024-08-17 00:26:21,946   INFO  cfg.MODEL.IMAGE_BACKBONE.CONVERT_WEIGHTS: True
2024-08-17 00:26:21,946   INFO  ----------- INIT_CFG -----------
2024-08-17 00:26:21,946   INFO  cfg.MODEL.IMAGE_BACKBONE.INIT_CFG.type: Pretrained
2024-08-17 00:26:21,946   INFO  cfg.MODEL.IMAGE_BACKBONE.INIT_CFG.checkpoint: /home/songziying/workspace/OpenPCDet/checkpoints/swint-nuimages-pretrained.pth
2024-08-17 00:26:21,946   INFO  ----------- NECK -----------
2024-08-17 00:26:21,946   INFO  cfg.MODEL.NECK.NAME: GeneralizedLSSFPN
2024-08-17 00:26:21,946   INFO  cfg.MODEL.NECK.IN_CHANNELS: [192, 384, 768]
2024-08-17 00:26:21,946   INFO  cfg.MODEL.NECK.OUT_CHANNELS: 256
2024-08-17 00:26:21,946   INFO  cfg.MODEL.NECK.START_LEVEL: 0
2024-08-17 00:26:21,946   INFO  cfg.MODEL.NECK.END_LEVEL: -1
2024-08-17 00:26:21,947   INFO  cfg.MODEL.NECK.NUM_OUTS: 3
2024-08-17 00:26:21,947   INFO  ----------- VTRANSFORM -----------
2024-08-17 00:26:21,947   INFO  cfg.MODEL.VTRANSFORM.NAME: DepthLSSTransform
2024-08-17 00:26:21,947   INFO  cfg.MODEL.VTRANSFORM.IMAGE_SIZE: [256, 704]
2024-08-17 00:26:21,947   INFO  cfg.MODEL.VTRANSFORM.IN_CHANNEL: 256
2024-08-17 00:26:21,947   INFO  cfg.MODEL.VTRANSFORM.OUT_CHANNEL: 80
2024-08-17 00:26:21,947   INFO  cfg.MODEL.VTRANSFORM.FEATURE_SIZE: [32, 88]
2024-08-17 00:26:21,947   INFO  cfg.MODEL.VTRANSFORM.XBOUND: [-54.0, 54.0, 0.3]
2024-08-17 00:26:21,947   INFO  cfg.MODEL.VTRANSFORM.YBOUND: [-54.0, 54.0, 0.3]
2024-08-17 00:26:21,947   INFO  cfg.MODEL.VTRANSFORM.ZBOUND: [-10.0, 10.0, 20.0]
2024-08-17 00:26:21,947   INFO  cfg.MODEL.VTRANSFORM.DBOUND: [1.0, 60.0, 0.5]
2024-08-17 00:26:21,947   INFO  cfg.MODEL.VTRANSFORM.DOWNSAMPLE: 2
2024-08-17 00:26:21,947   INFO  cfg.MODEL.VTRANSFORM.Noise: False
2024-08-17 00:26:21,947   INFO  ----------- FUSER -----------
2024-08-17 00:26:21,947   INFO  cfg.MODEL.FUSER.NAME: ConvFuser
2024-08-17 00:26:21,947   INFO  cfg.MODEL.FUSER.IN_CHANNEL: 336
2024-08-17 00:26:21,947   INFO  cfg.MODEL.FUSER.OUT_CHANNEL: 256
2024-08-17 00:26:21,947   INFO  ----------- BACKBONE_2D -----------
2024-08-17 00:26:21,947   INFO  cfg.MODEL.BACKBONE_2D.NAME: BaseBEVBackbone
2024-08-17 00:26:21,947   INFO  cfg.MODEL.BACKBONE_2D.LAYER_NUMS: [5, 5]
2024-08-17 00:26:21,947   INFO  cfg.MODEL.BACKBONE_2D.LAYER_STRIDES: [1, 2]
2024-08-17 00:26:21,947   INFO  cfg.MODEL.BACKBONE_2D.NUM_FILTERS: [128, 256]
2024-08-17 00:26:21,947   INFO  cfg.MODEL.BACKBONE_2D.UPSAMPLE_STRIDES: [1, 2]
2024-08-17 00:26:21,947   INFO  cfg.MODEL.BACKBONE_2D.NUM_UPSAMPLE_FILTERS: [256, 256]
2024-08-17 00:26:21,947   INFO  cfg.MODEL.BACKBONE_2D.USE_CONV_FOR_NO_STRIDE: True
2024-08-17 00:26:21,947   INFO  ----------- DENSE_HEAD -----------
2024-08-17 00:26:21,947   INFO  cfg.MODEL.DENSE_HEAD.CLASS_AGNOSTIC: False
2024-08-17 00:26:21,947   INFO  cfg.MODEL.DENSE_HEAD.NAME: TransFusionHead
2024-08-17 00:26:21,947   INFO  cfg.MODEL.DENSE_HEAD.USE_BIAS_BEFORE_NORM: False
2024-08-17 00:26:21,948   INFO  cfg.MODEL.DENSE_HEAD.NUM_PROPOSALS: 200
2024-08-17 00:26:21,948   INFO  cfg.MODEL.DENSE_HEAD.HIDDEN_CHANNEL: 128
2024-08-17 00:26:21,948   INFO  cfg.MODEL.DENSE_HEAD.NUM_CLASSES: 10
2024-08-17 00:26:21,948   INFO  cfg.MODEL.DENSE_HEAD.NUM_HEADS: 8
2024-08-17 00:26:21,948   INFO  cfg.MODEL.DENSE_HEAD.NMS_KERNEL_SIZE: 3
2024-08-17 00:26:21,948   INFO  cfg.MODEL.DENSE_HEAD.FFN_CHANNEL: 256
2024-08-17 00:26:21,948   INFO  cfg.MODEL.DENSE_HEAD.DROPOUT: 0.1
2024-08-17 00:26:21,948   INFO  cfg.MODEL.DENSE_HEAD.BN_MOMENTUM: 0.1
2024-08-17 00:26:21,948   INFO  cfg.MODEL.DENSE_HEAD.ACTIVATION: relu
2024-08-17 00:26:21,948   INFO  cfg.MODEL.DENSE_HEAD.NUM_HM_CONV: 2
2024-08-17 00:26:21,948   INFO  ----------- SEPARATE_HEAD_CFG -----------
2024-08-17 00:26:21,948   INFO  cfg.MODEL.DENSE_HEAD.SEPARATE_HEAD_CFG.HEAD_ORDER: ['center', 'height', 'dim', 'rot', 'vel']
2024-08-17 00:26:21,948   INFO  ----------- HEAD_DICT -----------
2024-08-17 00:26:21,948   INFO  ----------- center -----------
2024-08-17 00:26:21,948   INFO  cfg.MODEL.DENSE_HEAD.SEPARATE_HEAD_CFG.HEAD_DICT.center.out_channels: 2
2024-08-17 00:26:21,948   INFO  cfg.MODEL.DENSE_HEAD.SEPARATE_HEAD_CFG.HEAD_DICT.center.num_conv: 2
2024-08-17 00:26:21,948   INFO  ----------- height -----------
2024-08-17 00:26:21,948   INFO  cfg.MODEL.DENSE_HEAD.SEPARATE_HEAD_CFG.HEAD_DICT.height.out_channels: 1
2024-08-17 00:26:21,948   INFO  cfg.MODEL.DENSE_HEAD.SEPARATE_HEAD_CFG.HEAD_DICT.height.num_conv: 2
2024-08-17 00:26:21,948   INFO  ----------- dim -----------
2024-08-17 00:26:21,948   INFO  cfg.MODEL.DENSE_HEAD.SEPARATE_HEAD_CFG.HEAD_DICT.dim.out_channels: 3
2024-08-17 00:26:21,948   INFO  cfg.MODEL.DENSE_HEAD.SEPARATE_HEAD_CFG.HEAD_DICT.dim.num_conv: 2
2024-08-17 00:26:21,948   INFO  ----------- rot -----------
2024-08-17 00:26:21,948   INFO  cfg.MODEL.DENSE_HEAD.SEPARATE_HEAD_CFG.HEAD_DICT.rot.out_channels: 2
2024-08-17 00:26:21,948   INFO  cfg.MODEL.DENSE_HEAD.SEPARATE_HEAD_CFG.HEAD_DICT.rot.num_conv: 2
2024-08-17 00:26:21,948   INFO  ----------- vel -----------
2024-08-17 00:26:21,948   INFO  cfg.MODEL.DENSE_HEAD.SEPARATE_HEAD_CFG.HEAD_DICT.vel.out_channels: 2
2024-08-17 00:26:21,948   INFO  cfg.MODEL.DENSE_HEAD.SEPARATE_HEAD_CFG.HEAD_DICT.vel.num_conv: 2
2024-08-17 00:26:21,948   INFO  ----------- TARGET_ASSIGNER_CONFIG -----------
2024-08-17 00:26:21,949   INFO  cfg.MODEL.DENSE_HEAD.TARGET_ASSIGNER_CONFIG.FEATURE_MAP_STRIDE: 8
2024-08-17 00:26:21,949   INFO  cfg.MODEL.DENSE_HEAD.TARGET_ASSIGNER_CONFIG.DATASET: nuScenes
2024-08-17 00:26:21,949   INFO  cfg.MODEL.DENSE_HEAD.TARGET_ASSIGNER_CONFIG.GAUSSIAN_OVERLAP: 0.1
2024-08-17 00:26:21,949   INFO  cfg.MODEL.DENSE_HEAD.TARGET_ASSIGNER_CONFIG.MIN_RADIUS: 2
2024-08-17 00:26:21,949   INFO  ----------- HUNGARIAN_ASSIGNER -----------
2024-08-17 00:26:21,949   INFO  ----------- cls_cost -----------
2024-08-17 00:26:21,949   INFO  cfg.MODEL.DENSE_HEAD.TARGET_ASSIGNER_CONFIG.HUNGARIAN_ASSIGNER.cls_cost.gamma: 2.0
2024-08-17 00:26:21,949   INFO  cfg.MODEL.DENSE_HEAD.TARGET_ASSIGNER_CONFIG.HUNGARIAN_ASSIGNER.cls_cost.alpha: 0.25
2024-08-17 00:26:21,949   INFO  cfg.MODEL.DENSE_HEAD.TARGET_ASSIGNER_CONFIG.HUNGARIAN_ASSIGNER.cls_cost.weight: 0.15
2024-08-17 00:26:21,949   INFO  ----------- reg_cost -----------
2024-08-17 00:26:21,949   INFO  cfg.MODEL.DENSE_HEAD.TARGET_ASSIGNER_CONFIG.HUNGARIAN_ASSIGNER.reg_cost.weight: 0.25
2024-08-17 00:26:21,949   INFO  ----------- iou_cost -----------
2024-08-17 00:26:21,949   INFO  cfg.MODEL.DENSE_HEAD.TARGET_ASSIGNER_CONFIG.HUNGARIAN_ASSIGNER.iou_cost.weight: 0.25
2024-08-17 00:26:21,949   INFO  ----------- LOSS_CONFIG -----------
2024-08-17 00:26:21,949   INFO  ----------- LOSS_WEIGHTS -----------
2024-08-17 00:26:21,949   INFO  cfg.MODEL.DENSE_HEAD.LOSS_CONFIG.LOSS_WEIGHTS.cls_weight: 1.0
2024-08-17 00:26:21,949   INFO  cfg.MODEL.DENSE_HEAD.LOSS_CONFIG.LOSS_WEIGHTS.bbox_weight: 0.25
2024-08-17 00:26:21,949   INFO  cfg.MODEL.DENSE_HEAD.LOSS_CONFIG.LOSS_WEIGHTS.hm_weight: 1.0
2024-08-17 00:26:21,949   INFO  cfg.MODEL.DENSE_HEAD.LOSS_CONFIG.LOSS_WEIGHTS.code_weights: [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.2, 0.2]
2024-08-17 00:26:21,949   INFO  ----------- LOSS_CLS -----------
2024-08-17 00:26:21,949   INFO  cfg.MODEL.DENSE_HEAD.LOSS_CONFIG.LOSS_CLS.use_sigmoid: True
2024-08-17 00:26:21,949   INFO  cfg.MODEL.DENSE_HEAD.LOSS_CONFIG.LOSS_CLS.gamma: 2.0
2024-08-17 00:26:21,949   INFO  cfg.MODEL.DENSE_HEAD.LOSS_CONFIG.LOSS_CLS.alpha: 0.25
2024-08-17 00:26:21,949   INFO  ----------- POST_PROCESSING -----------
2024-08-17 00:26:21,949   INFO  cfg.MODEL.DENSE_HEAD.POST_PROCESSING.SCORE_THRESH: 0.0
2024-08-17 00:26:21,949   INFO  cfg.MODEL.DENSE_HEAD.POST_PROCESSING.POST_CENTER_RANGE: [-61.2, -61.2, -10.0, 61.2, 61.2, 10.0]
2024-08-17 00:26:21,949   INFO  ----------- POST_PROCESSING -----------
2024-08-17 00:26:21,949   INFO  cfg.MODEL.POST_PROCESSING.RECALL_THRESH_LIST: [0.3, 0.5, 0.7]
2024-08-17 00:26:21,949   INFO  cfg.MODEL.POST_PROCESSING.SCORE_THRESH: 0.1
2024-08-17 00:26:21,950   INFO  cfg.MODEL.POST_PROCESSING.OUTPUT_RAW_SCORE: False
2024-08-17 00:26:21,950   INFO  cfg.MODEL.POST_PROCESSING.EVAL_METRIC: kitti
2024-08-17 00:26:21,950   INFO  ----------- OPTIMIZATION -----------
2024-08-17 00:26:21,950   INFO  cfg.OPTIMIZATION.BATCH_SIZE_PER_GPU: 1
2024-08-17 00:26:21,950   INFO  cfg.OPTIMIZATION.NUM_EPOCHS: 20
2024-08-17 00:26:21,950   INFO  cfg.OPTIMIZATION.OPTIMIZER: adam_cosineanneal
2024-08-17 00:26:21,950   INFO  cfg.OPTIMIZATION.LR: 0.0001
2024-08-17 00:26:21,950   INFO  cfg.OPTIMIZATION.WEIGHT_DECAY: 0.01
2024-08-17 00:26:21,950   INFO  cfg.OPTIMIZATION.MOMENTUM: 0.9
2024-08-17 00:26:21,950   INFO  cfg.OPTIMIZATION.BETAS: [0.9, 0.999]
2024-08-17 00:26:21,950   INFO  cfg.OPTIMIZATION.MOMS: [0.9, 0.8052631]
2024-08-17 00:26:21,950   INFO  cfg.OPTIMIZATION.PCT_START: 0.4
2024-08-17 00:26:21,950   INFO  cfg.OPTIMIZATION.WARMUP_ITER: 500
2024-08-17 00:26:21,950   INFO  cfg.OPTIMIZATION.DECAY_STEP_LIST: [35, 45]
2024-08-17 00:26:21,950   INFO  cfg.OPTIMIZATION.LR_WARMUP: False
2024-08-17 00:26:21,950   INFO  cfg.OPTIMIZATION.WARMUP_EPOCH: 1
2024-08-17 00:26:21,950   INFO  cfg.OPTIMIZATION.GRAD_NORM_CLIP: 35
2024-08-17 00:26:21,950   INFO  cfg.OPTIMIZATION.LOSS_SCALE_FP16: 32
2024-08-17 00:26:21,950   INFO  cfg.TAG: bevfusion
2024-08-17 00:26:21,950   INFO  cfg.EXP_GROUP_PATH: nuscenes_models
2024-08-17 00:26:21,967   INFO  ----------- Create dataloader & network & optimizer -----------
2024-08-17 00:26:21,968   INFO  Loading NuScenes dataset
2024-08-17 00:26:22,907   INFO  Total samples for NuScenes dataset: 7034
2024-08-17 00:26:22,979   INFO  Total samples after balanced resampling: 30950
2024-08-17 00:26:25,910   INFO  ==> Loading parameters from checkpoint /home/songziying/workspace/OpenPCDet/output/nuscenes_models/bevfusion/bevfusion_baseline_1_4_split_scenes/ckpt/checkpoint_epoch_20.pth to CPU
2024-08-17 00:26:26,235   INFO  ==> Loading optimizer parameters from checkpoint /home/songziying/workspace/OpenPCDet/output/nuscenes_models/bevfusion/bevfusion_baseline_1_4_split_scenes/ckpt/checkpoint_epoch_20.pth to CPU
2024-08-17 00:26:26,466   INFO  ==> Done
2024-08-17 00:26:27,138   INFO  ----------- Model BevFusion created, param count: 40800087 -----------
2024-08-17 00:26:27,138   INFO  DistributedDataParallel(
  (module): BevFusion(
    (vfe): MeanVFE()
    (backbone_3d): VoxelResBackBone8x(
      (conv_input): SparseSequential(
        (0): SubMConv3d(5, 16, kernel_size=[3, 3, 3], stride=[1, 1, 1], padding=[1, 1, 1], dilation=[1, 1, 1], output_padding=[0, 0, 0], bias=False, algo=ConvAlgo.MaskImplicitGemm)
        (1): BatchNorm1d(16, eps=0.001, momentum=0.01, affine=True, track_running_stats=True)
        (2): ReLU()
      )
      (conv1): SparseSequential(
        (0): SparseBasicBlock(
          (conv1): SubMConv3d(16, 16, kernel_size=[3, 3, 3], stride=[1, 1, 1], padding=[1, 1, 1], dilation=[1, 1, 1], output_padding=[0, 0, 0], bias=False, algo=ConvAlgo.MaskImplicitGemm)
          (bn1): BatchNorm1d(16, eps=0.001, momentum=0.01, affine=True, track_running_stats=True)
          (relu): ReLU()
          (conv2): SubMConv3d(16, 16, kernel_size=[3, 3, 3], stride=[1, 1, 1], padding=[1, 1, 1], dilation=[1, 1, 1], output_padding=[0, 0, 0], bias=False, algo=ConvAlgo.MaskImplicitGemm)
          (bn2): BatchNorm1d(16, eps=0.001, momentum=0.01, affine=True, track_running_stats=True)
        )
        (1): SparseBasicBlock(
          (conv1): SubMConv3d(16, 16, kernel_size=[3, 3, 3], stride=[1, 1, 1], padding=[1, 1, 1], dilation=[1, 1, 1], output_padding=[0, 0, 0], bias=False, algo=ConvAlgo.MaskImplicitGemm)
          (bn1): BatchNorm1d(16, eps=0.001, momentum=0.01, affine=True, track_running_stats=True)
          (relu): ReLU()
          (conv2): SubMConv3d(16, 16, kernel_size=[3, 3, 3], stride=[1, 1, 1], padding=[1, 1, 1], dilation=[1, 1, 1], output_padding=[0, 0, 0], bias=False, algo=ConvAlgo.MaskImplicitGemm)
          (bn2): BatchNorm1d(16, eps=0.001, momentum=0.01, affine=True, track_running_stats=True)
        )
      )
      (conv2): SparseSequential(
        (0): SparseSequential(
          (0): SparseConv3d(16, 32, kernel_size=[3, 3, 3], stride=[2, 2, 2], padding=[1, 1, 1], dilation=[1, 1, 1], output_padding=[0, 0, 0], bias=False, algo=ConvAlgo.MaskImplicitGemm)
          (1): BatchNorm1d(32, eps=0.001, momentum=0.01, affine=True, track_running_stats=True)
          (2): ReLU()
        )
        (1): SparseBasicBlock(
          (conv1): SubMConv3d(32, 32, kernel_size=[3, 3, 3], stride=[1, 1, 1], padding=[1, 1, 1], dilation=[1, 1, 1], output_padding=[0, 0, 0], bias=False, algo=ConvAlgo.MaskImplicitGemm)
          (bn1): BatchNorm1d(32, eps=0.001, momentum=0.01, affine=True, track_running_stats=True)
          (relu): ReLU()
          (conv2): SubMConv3d(32, 32, kernel_size=[3, 3, 3], stride=[1, 1, 1], padding=[1, 1, 1], dilation=[1, 1, 1], output_padding=[0, 0, 0], bias=False, algo=ConvAlgo.MaskImplicitGemm)
          (bn2): BatchNorm1d(32, eps=0.001, momentum=0.01, affine=True, track_running_stats=True)
        )
        (2): SparseBasicBlock(
          (conv1): SubMConv3d(32, 32, kernel_size=[3, 3, 3], stride=[1, 1, 1], padding=[1, 1, 1], dilation=[1, 1, 1], output_padding=[0, 0, 0], bias=False, algo=ConvAlgo.MaskImplicitGemm)
          (bn1): BatchNorm1d(32, eps=0.001, momentum=0.01, affine=True, track_running_stats=True)
          (relu): ReLU()
          (conv2): SubMConv3d(32, 32, kernel_size=[3, 3, 3], stride=[1, 1, 1], padding=[1, 1, 1], dilation=[1, 1, 1], output_padding=[0, 0, 0], bias=False, algo=ConvAlgo.MaskImplicitGemm)
          (bn2): BatchNorm1d(32, eps=0.001, momentum=0.01, affine=True, track_running_stats=True)
        )
      )
      (conv3): SparseSequential(
        (0): SparseSequential(
          (0): SparseConv3d(32, 64, kernel_size=[3, 3, 3], stride=[2, 2, 2], padding=[1, 1, 1], dilation=[1, 1, 1], output_padding=[0, 0, 0], bias=False, algo=ConvAlgo.MaskImplicitGemm)
          (1): BatchNorm1d(64, eps=0.001, momentum=0.01, affine=True, track_running_stats=True)
          (2): ReLU()
        )
        (1): SparseBasicBlock(
          (conv1): SubMConv3d(64, 64, kernel_size=[3, 3, 3], stride=[1, 1, 1], padding=[1, 1, 1], dilation=[1, 1, 1], output_padding=[0, 0, 0], bias=False, algo=ConvAlgo.MaskImplicitGemm)
          (bn1): BatchNorm1d(64, eps=0.001, momentum=0.01, affine=True, track_running_stats=True)
          (relu): ReLU()
          (conv2): SubMConv3d(64, 64, kernel_size=[3, 3, 3], stride=[1, 1, 1], padding=[1, 1, 1], dilation=[1, 1, 1], output_padding=[0, 0, 0], bias=False, algo=ConvAlgo.MaskImplicitGemm)
          (bn2): BatchNorm1d(64, eps=0.001, momentum=0.01, affine=True, track_running_stats=True)
        )
        (2): SparseBasicBlock(
          (conv1): SubMConv3d(64, 64, kernel_size=[3, 3, 3], stride=[1, 1, 1], padding=[1, 1, 1], dilation=[1, 1, 1], output_padding=[0, 0, 0], bias=False, algo=ConvAlgo.MaskImplicitGemm)
          (bn1): BatchNorm1d(64, eps=0.001, momentum=0.01, affine=True, track_running_stats=True)
          (relu): ReLU()
          (conv2): SubMConv3d(64, 64, kernel_size=[3, 3, 3], stride=[1, 1, 1], padding=[1, 1, 1], dilation=[1, 1, 1], output_padding=[0, 0, 0], bias=False, algo=ConvAlgo.MaskImplicitGemm)
          (bn2): BatchNorm1d(64, eps=0.001, momentum=0.01, affine=True, track_running_stats=True)
        )
      )
      (conv4): SparseSequential(
        (0): SparseSequential(
          (0): SparseConv3d(64, 128, kernel_size=[3, 3, 3], stride=[2, 2, 2], padding=[0, 1, 1], dilation=[1, 1, 1], output_padding=[0, 0, 0], bias=False, algo=ConvAlgo.MaskImplicitGemm)
          (1): BatchNorm1d(128, eps=0.001, momentum=0.01, affine=True, track_running_stats=True)
          (2): ReLU()
        )
        (1): SparseBasicBlock(
          (conv1): SubMConv3d(128, 128, kernel_size=[3, 3, 3], stride=[1, 1, 1], padding=[1, 1, 1], dilation=[1, 1, 1], output_padding=[0, 0, 0], bias=False, algo=ConvAlgo.MaskImplicitGemm)
          (bn1): BatchNorm1d(128, eps=0.001, momentum=0.01, affine=True, track_running_stats=True)
          (relu): ReLU()
          (conv2): SubMConv3d(128, 128, kernel_size=[3, 3, 3], stride=[1, 1, 1], padding=[1, 1, 1], dilation=[1, 1, 1], output_padding=[0, 0, 0], bias=False, algo=ConvAlgo.MaskImplicitGemm)
          (bn2): BatchNorm1d(128, eps=0.001, momentum=0.01, affine=True, track_running_stats=True)
        )
        (2): SparseBasicBlock(
          (conv1): SubMConv3d(128, 128, kernel_size=[3, 3, 3], stride=[1, 1, 1], padding=[1, 1, 1], dilation=[1, 1, 1], output_padding=[0, 0, 0], bias=False, algo=ConvAlgo.MaskImplicitGemm)
          (bn1): BatchNorm1d(128, eps=0.001, momentum=0.01, affine=True, track_running_stats=True)
          (relu): ReLU()
          (conv2): SubMConv3d(128, 128, kernel_size=[3, 3, 3], stride=[1, 1, 1], padding=[1, 1, 1], dilation=[1, 1, 1], output_padding=[0, 0, 0], bias=False, algo=ConvAlgo.MaskImplicitGemm)
          (bn2): BatchNorm1d(128, eps=0.001, momentum=0.01, affine=True, track_running_stats=True)
        )
      )
      (conv_out): SparseSequential(
        (0): SparseConv3d(128, 128, kernel_size=[3, 1, 1], stride=[2, 1, 1], padding=[0, 0, 0], dilation=[1, 1, 1], output_padding=[0, 0, 0], bias=False, algo=ConvAlgo.MaskImplicitGemm)
        (1): BatchNorm1d(128, eps=0.001, momentum=0.01, affine=True, track_running_stats=True)
        (2): ReLU()
      )
    )
    (map_to_bev_module): HeightCompression()
    (pfe): None
    (image_backbone): SwinTransformer(
      (patch_embed): PatchEmbed(
        (adap_padding): AdaptivePadding()
        (projection): Conv2d(3, 96, kernel_size=(4, 4), stride=(4, 4))
        (norm): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_after_pos): Dropout(p=0.0, inplace=False)
      (stages): ModuleList(
        (0): SwinBlockSequence(
          (blocks): ModuleList(
            (0): SwinBlock(
              (norm1): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
              (attn): ShiftWindowMSA(
                (w_msa): WindowMSA(
                  (qkv): Linear(in_features=96, out_features=288, bias=True)
                  (attn_drop): Dropout(p=0.0, inplace=False)
                  (proj): Linear(in_features=96, out_features=96, bias=True)
                  (proj_drop): Dropout(p=0.0, inplace=False)
                  (softmax): Softmax(dim=-1)
                )
                (drop): DropPath()
              )
              (norm2): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
              (ffn): FFN(
                (activate): GELU(approximate=none)
                (layers): Sequential(
                  (0): Sequential(
                    (0): Linear(in_features=96, out_features=384, bias=True)
                    (1): GELU(approximate=none)
                    (2): Dropout(p=0.0, inplace=False)
                  )
                  (1): Linear(in_features=384, out_features=96, bias=True)
                  (2): Dropout(p=0.0, inplace=False)
                )
                (dropout_layer): DropPath()
              )
            )
            (1): SwinBlock(
              (norm1): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
              (attn): ShiftWindowMSA(
                (w_msa): WindowMSA(
                  (qkv): Linear(in_features=96, out_features=288, bias=True)
                  (attn_drop): Dropout(p=0.0, inplace=False)
                  (proj): Linear(in_features=96, out_features=96, bias=True)
                  (proj_drop): Dropout(p=0.0, inplace=False)
                  (softmax): Softmax(dim=-1)
                )
                (drop): DropPath()
              )
              (norm2): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
              (ffn): FFN(
                (activate): GELU(approximate=none)
                (layers): Sequential(
                  (0): Sequential(
                    (0): Linear(in_features=96, out_features=384, bias=True)
                    (1): GELU(approximate=none)
                    (2): Dropout(p=0.0, inplace=False)
                  )
                  (1): Linear(in_features=384, out_features=96, bias=True)
                  (2): Dropout(p=0.0, inplace=False)
                )
                (dropout_layer): DropPath()
              )
            )
          )
          (downsample): PatchMerging(
            (adap_padding): AdaptivePadding()
            (sampler): Unfold(kernel_size=(2, 2), dilation=(1, 1), padding=(0, 0), stride=(2, 2))
            (norm): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (reduction): Linear(in_features=384, out_features=192, bias=False)
          )
        )
        (1): SwinBlockSequence(
          (blocks): ModuleList(
            (0): SwinBlock(
              (norm1): LayerNorm((192,), eps=1e-05, elementwise_affine=True)
              (attn): ShiftWindowMSA(
                (w_msa): WindowMSA(
                  (qkv): Linear(in_features=192, out_features=576, bias=True)
                  (attn_drop): Dropout(p=0.0, inplace=False)
                  (proj): Linear(in_features=192, out_features=192, bias=True)
                  (proj_drop): Dropout(p=0.0, inplace=False)
                  (softmax): Softmax(dim=-1)
                )
                (drop): DropPath()
              )
              (norm2): LayerNorm((192,), eps=1e-05, elementwise_affine=True)
              (ffn): FFN(
                (activate): GELU(approximate=none)
                (layers): Sequential(
                  (0): Sequential(
                    (0): Linear(in_features=192, out_features=768, bias=True)
                    (1): GELU(approximate=none)
                    (2): Dropout(p=0.0, inplace=False)
                  )
                  (1): Linear(in_features=768, out_features=192, bias=True)
                  (2): Dropout(p=0.0, inplace=False)
                )
                (dropout_layer): DropPath()
              )
            )
            (1): SwinBlock(
              (norm1): LayerNorm((192,), eps=1e-05, elementwise_affine=True)
              (attn): ShiftWindowMSA(
                (w_msa): WindowMSA(
                  (qkv): Linear(in_features=192, out_features=576, bias=True)
                  (attn_drop): Dropout(p=0.0, inplace=False)
                  (proj): Linear(in_features=192, out_features=192, bias=True)
                  (proj_drop): Dropout(p=0.0, inplace=False)
                  (softmax): Softmax(dim=-1)
                )
                (drop): DropPath()
              )
              (norm2): LayerNorm((192,), eps=1e-05, elementwise_affine=True)
              (ffn): FFN(
                (activate): GELU(approximate=none)
                (layers): Sequential(
                  (0): Sequential(
                    (0): Linear(in_features=192, out_features=768, bias=True)
                    (1): GELU(approximate=none)
                    (2): Dropout(p=0.0, inplace=False)
                  )
                  (1): Linear(in_features=768, out_features=192, bias=True)
                  (2): Dropout(p=0.0, inplace=False)
                )
                (dropout_layer): DropPath()
              )
            )
          )
          (downsample): PatchMerging(
            (adap_padding): AdaptivePadding()
            (sampler): Unfold(kernel_size=(2, 2), dilation=(1, 1), padding=(0, 0), stride=(2, 2))
            (norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (reduction): Linear(in_features=768, out_features=384, bias=False)
          )
        )
        (2): SwinBlockSequence(
          (blocks): ModuleList(
            (0): SwinBlock(
              (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
              (attn): ShiftWindowMSA(
                (w_msa): WindowMSA(
                  (qkv): Linear(in_features=384, out_features=1152, bias=True)
                  (attn_drop): Dropout(p=0.0, inplace=False)
                  (proj): Linear(in_features=384, out_features=384, bias=True)
                  (proj_drop): Dropout(p=0.0, inplace=False)
                  (softmax): Softmax(dim=-1)
                )
                (drop): DropPath()
              )
              (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
              (ffn): FFN(
                (activate): GELU(approximate=none)
                (layers): Sequential(
                  (0): Sequential(
                    (0): Linear(in_features=384, out_features=1536, bias=True)
                    (1): GELU(approximate=none)
                    (2): Dropout(p=0.0, inplace=False)
                  )
                  (1): Linear(in_features=1536, out_features=384, bias=True)
                  (2): Dropout(p=0.0, inplace=False)
                )
                (dropout_layer): DropPath()
              )
            )
            (1): SwinBlock(
              (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
              (attn): ShiftWindowMSA(
                (w_msa): WindowMSA(
                  (qkv): Linear(in_features=384, out_features=1152, bias=True)
                  (attn_drop): Dropout(p=0.0, inplace=False)
                  (proj): Linear(in_features=384, out_features=384, bias=True)
                  (proj_drop): Dropout(p=0.0, inplace=False)
                  (softmax): Softmax(dim=-1)
                )
                (drop): DropPath()
              )
              (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
              (ffn): FFN(
                (activate): GELU(approximate=none)
                (layers): Sequential(
                  (0): Sequential(
                    (0): Linear(in_features=384, out_features=1536, bias=True)
                    (1): GELU(approximate=none)
                    (2): Dropout(p=0.0, inplace=False)
                  )
                  (1): Linear(in_features=1536, out_features=384, bias=True)
                  (2): Dropout(p=0.0, inplace=False)
                )
                (dropout_layer): DropPath()
              )
            )
            (2): SwinBlock(
              (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
              (attn): ShiftWindowMSA(
                (w_msa): WindowMSA(
                  (qkv): Linear(in_features=384, out_features=1152, bias=True)
                  (attn_drop): Dropout(p=0.0, inplace=False)
                  (proj): Linear(in_features=384, out_features=384, bias=True)
                  (proj_drop): Dropout(p=0.0, inplace=False)
                  (softmax): Softmax(dim=-1)
                )
                (drop): DropPath()
              )
              (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
              (ffn): FFN(
                (activate): GELU(approximate=none)
                (layers): Sequential(
                  (0): Sequential(
                    (0): Linear(in_features=384, out_features=1536, bias=True)
                    (1): GELU(approximate=none)
                    (2): Dropout(p=0.0, inplace=False)
                  )
                  (1): Linear(in_features=1536, out_features=384, bias=True)
                  (2): Dropout(p=0.0, inplace=False)
                )
                (dropout_layer): DropPath()
              )
            )
            (3): SwinBlock(
              (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
              (attn): ShiftWindowMSA(
                (w_msa): WindowMSA(
                  (qkv): Linear(in_features=384, out_features=1152, bias=True)
                  (attn_drop): Dropout(p=0.0, inplace=False)
                  (proj): Linear(in_features=384, out_features=384, bias=True)
                  (proj_drop): Dropout(p=0.0, inplace=False)
                  (softmax): Softmax(dim=-1)
                )
                (drop): DropPath()
              )
              (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
              (ffn): FFN(
                (activate): GELU(approximate=none)
                (layers): Sequential(
                  (0): Sequential(
                    (0): Linear(in_features=384, out_features=1536, bias=True)
                    (1): GELU(approximate=none)
                    (2): Dropout(p=0.0, inplace=False)
                  )
                  (1): Linear(in_features=1536, out_features=384, bias=True)
                  (2): Dropout(p=0.0, inplace=False)
                )
                (dropout_layer): DropPath()
              )
            )
            (4): SwinBlock(
              (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
              (attn): ShiftWindowMSA(
                (w_msa): WindowMSA(
                  (qkv): Linear(in_features=384, out_features=1152, bias=True)
                  (attn_drop): Dropout(p=0.0, inplace=False)
                  (proj): Linear(in_features=384, out_features=384, bias=True)
                  (proj_drop): Dropout(p=0.0, inplace=False)
                  (softmax): Softmax(dim=-1)
                )
                (drop): DropPath()
              )
              (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
              (ffn): FFN(
                (activate): GELU(approximate=none)
                (layers): Sequential(
                  (0): Sequential(
                    (0): Linear(in_features=384, out_features=1536, bias=True)
                    (1): GELU(approximate=none)
                    (2): Dropout(p=0.0, inplace=False)
                  )
                  (1): Linear(in_features=1536, out_features=384, bias=True)
                  (2): Dropout(p=0.0, inplace=False)
                )
                (dropout_layer): DropPath()
              )
            )
            (5): SwinBlock(
              (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
              (attn): ShiftWindowMSA(
                (w_msa): WindowMSA(
                  (qkv): Linear(in_features=384, out_features=1152, bias=True)
                  (attn_drop): Dropout(p=0.0, inplace=False)
                  (proj): Linear(in_features=384, out_features=384, bias=True)
                  (proj_drop): Dropout(p=0.0, inplace=False)
                  (softmax): Softmax(dim=-1)
                )
                (drop): DropPath()
              )
              (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
              (ffn): FFN(
                (activate): GELU(approximate=none)
                (layers): Sequential(
                  (0): Sequential(
                    (0): Linear(in_features=384, out_features=1536, bias=True)
                    (1): GELU(approximate=none)
                    (2): Dropout(p=0.0, inplace=False)
                  )
                  (1): Linear(in_features=1536, out_features=384, bias=True)
                  (2): Dropout(p=0.0, inplace=False)
                )
                (dropout_layer): DropPath()
              )
            )
          )
          (downsample): PatchMerging(
            (adap_padding): AdaptivePadding()
            (sampler): Unfold(kernel_size=(2, 2), dilation=(1, 1), padding=(0, 0), stride=(2, 2))
            (norm): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
            (reduction): Linear(in_features=1536, out_features=768, bias=False)
          )
        )
        (3): SwinBlockSequence(
          (blocks): ModuleList(
            (0): SwinBlock(
              (norm1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
              (attn): ShiftWindowMSA(
                (w_msa): WindowMSA(
                  (qkv): Linear(in_features=768, out_features=2304, bias=True)
                  (attn_drop): Dropout(p=0.0, inplace=False)
                  (proj): Linear(in_features=768, out_features=768, bias=True)
                  (proj_drop): Dropout(p=0.0, inplace=False)
                  (softmax): Softmax(dim=-1)
                )
                (drop): DropPath()
              )
              (norm2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
              (ffn): FFN(
                (activate): GELU(approximate=none)
                (layers): Sequential(
                  (0): Sequential(
                    (0): Linear(in_features=768, out_features=3072, bias=True)
                    (1): GELU(approximate=none)
                    (2): Dropout(p=0.0, inplace=False)
                  )
                  (1): Linear(in_features=3072, out_features=768, bias=True)
                  (2): Dropout(p=0.0, inplace=False)
                )
                (dropout_layer): DropPath()
              )
            )
            (1): SwinBlock(
              (norm1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
              (attn): ShiftWindowMSA(
                (w_msa): WindowMSA(
                  (qkv): Linear(in_features=768, out_features=2304, bias=True)
                  (attn_drop): Dropout(p=0.0, inplace=False)
                  (proj): Linear(in_features=768, out_features=768, bias=True)
                  (proj_drop): Dropout(p=0.0, inplace=False)
                  (softmax): Softmax(dim=-1)
                )
                (drop): DropPath()
              )
              (norm2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
              (ffn): FFN(
                (activate): GELU(approximate=none)
                (layers): Sequential(
                  (0): Sequential(
                    (0): Linear(in_features=768, out_features=3072, bias=True)
                    (1): GELU(approximate=none)
                    (2): Dropout(p=0.0, inplace=False)
                  )
                  (1): Linear(in_features=3072, out_features=768, bias=True)
                  (2): Dropout(p=0.0, inplace=False)
                )
                (dropout_layer): DropPath()
              )
            )
          )
        )
      )
      (norm1): LayerNorm((192,), eps=1e-05, elementwise_affine=True)
      (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
      (norm3): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    )
    (neck): GeneralizedLSSFPN(
      (lateral_convs): ModuleList(
        (0): BasicBlock2D(
          (conv): Conv2d(448, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
        )
        (1): BasicBlock2D(
          (conv): Conv2d(1152, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
        )
      )
      (fpn_convs): ModuleList(
        (0): BasicBlock2D(
          (conv): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
        )
        (1): BasicBlock2D(
          (conv): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
        )
      )
    )
    (vtransform): DepthLSSTransform(
      (dtransform): Sequential(
        (0): Conv2d(1, 8, kernel_size=(1, 1), stride=(1, 1))
        (1): BatchNorm2d(8, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (2): ReLU(inplace=True)
        (3): Conv2d(8, 32, kernel_size=(5, 5), stride=(4, 4), padding=(2, 2))
        (4): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (5): ReLU(inplace=True)
        (6): Conv2d(32, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (7): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (8): ReLU(inplace=True)
      )
      (depthnet): Sequential(
        (0): Conv2d(320, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (2): ReLU(inplace=True)
        (3): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        (4): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (5): ReLU(inplace=True)
        (6): Conv2d(256, 198, kernel_size=(1, 1), stride=(1, 1))
      )
      (downsample): Sequential(
        (0): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (2): ReLU(inplace=True)
        (3): Conv2d(80, 80, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (4): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (5): ReLU(inplace=True)
        (6): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (7): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (8): ReLU(inplace=True)
      )
    )
    (fuser): ConvFuser(
      (conv): Sequential(
        (0): Conv2d(336, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (2): ReLU(inplace=True)
      )
    )
    (backbone_2d): BaseBEVBackbone(
      (blocks): ModuleList(
        (0): Sequential(
          (0): ZeroPad2d((1, 1, 1, 1))
          (1): Conv2d(256, 128, kernel_size=(3, 3), stride=(1, 1), bias=False)
          (2): BatchNorm2d(128, eps=0.001, momentum=0.01, affine=True, track_running_stats=True)
          (3): ReLU()
          (4): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (5): BatchNorm2d(128, eps=0.001, momentum=0.01, affine=True, track_running_stats=True)
          (6): ReLU()
          (7): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (8): BatchNorm2d(128, eps=0.001, momentum=0.01, affine=True, track_running_stats=True)
          (9): ReLU()
          (10): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (11): BatchNorm2d(128, eps=0.001, momentum=0.01, affine=True, track_running_stats=True)
          (12): ReLU()
          (13): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (14): BatchNorm2d(128, eps=0.001, momentum=0.01, affine=True, track_running_stats=True)
          (15): ReLU()
          (16): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (17): BatchNorm2d(128, eps=0.001, momentum=0.01, affine=True, track_running_stats=True)
          (18): ReLU()
        )
        (1): Sequential(
          (0): ZeroPad2d((1, 1, 1, 1))
          (1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), bias=False)
          (2): BatchNorm2d(256, eps=0.001, momentum=0.01, affine=True, track_running_stats=True)
          (3): ReLU()
          (4): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (5): BatchNorm2d(256, eps=0.001, momentum=0.01, affine=True, track_running_stats=True)
          (6): ReLU()
          (7): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (8): BatchNorm2d(256, eps=0.001, momentum=0.01, affine=True, track_running_stats=True)
          (9): ReLU()
          (10): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (11): BatchNorm2d(256, eps=0.001, momentum=0.01, affine=True, track_running_stats=True)
          (12): ReLU()
          (13): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (14): BatchNorm2d(256, eps=0.001, momentum=0.01, affine=True, track_running_stats=True)
          (15): ReLU()
          (16): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (17): BatchNorm2d(256, eps=0.001, momentum=0.01, affine=True, track_running_stats=True)
          (18): ReLU()
        )
      )
      (deblocks): ModuleList(
        (0): Sequential(
          (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (1): BatchNorm2d(256, eps=0.001, momentum=0.01, affine=True, track_running_stats=True)
          (2): ReLU()
        )
        (1): Sequential(
          (0): ConvTranspose2d(256, 256, kernel_size=(2, 2), stride=(2, 2), bias=False)
          (1): BatchNorm2d(256, eps=0.001, momentum=0.01, affine=True, track_running_stats=True)
          (2): ReLU()
        )
      )
    )
    (dense_head): TransFusionHead(
      (loss_cls): SigmoidFocalClassificationLoss()
      (loss_bbox): L1Loss()
      (loss_heatmap): GaussianFocalLoss()
      (custom_loss): CustomLoss()
      (shared_conv): Conv2d(512, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      (heatmap_head): Sequential(
        (0): BasicBlock2D(
          (conv): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
        )
        (1): Conv2d(128, 10, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      )
      (class_encoding): Conv1d(10, 128, kernel_size=(1,), stride=(1,))
      (decoder): TransformerDecoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=128, out_features=128, bias=True)
        )
        (multihead_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=128, out_features=128, bias=True)
        )
        (linear1): Linear(in_features=128, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=128, bias=True)
        (norm1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
        (norm2): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
        (norm3): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
        (dropout3): Dropout(p=0.1, inplace=False)
        (self_posembed): PositionEmbeddingLearned(
          (position_embedding_head): Sequential(
            (0): Conv1d(2, 128, kernel_size=(1,), stride=(1,))
            (1): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (2): ReLU(inplace=True)
            (3): Conv1d(128, 128, kernel_size=(1,), stride=(1,))
          )
        )
        (cross_posembed): PositionEmbeddingLearned(
          (position_embedding_head): Sequential(
            (0): Conv1d(2, 128, kernel_size=(1,), stride=(1,))
            (1): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (2): ReLU(inplace=True)
            (3): Conv1d(128, 128, kernel_size=(1,), stride=(1,))
          )
        )
      )
      (prediction_head): SeparateHead_Transfusion(
        (center): Sequential(
          (0): Sequential(
            (0): Conv1d(128, 64, kernel_size=(1,), stride=(1,), bias=False)
            (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (2): ReLU()
          )
          (1): Conv1d(64, 2, kernel_size=(1,), stride=(1,))
        )
        (height): Sequential(
          (0): Sequential(
            (0): Conv1d(128, 64, kernel_size=(1,), stride=(1,), bias=False)
            (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (2): ReLU()
          )
          (1): Conv1d(64, 1, kernel_size=(1,), stride=(1,))
        )
        (dim): Sequential(
          (0): Sequential(
            (0): Conv1d(128, 64, kernel_size=(1,), stride=(1,), bias=False)
            (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (2): ReLU()
          )
          (1): Conv1d(64, 3, kernel_size=(1,), stride=(1,))
        )
        (rot): Sequential(
          (0): Sequential(
            (0): Conv1d(128, 64, kernel_size=(1,), stride=(1,), bias=False)
            (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (2): ReLU()
          )
          (1): Conv1d(64, 2, kernel_size=(1,), stride=(1,))
        )
        (vel): Sequential(
          (0): Sequential(
            (0): Conv1d(128, 64, kernel_size=(1,), stride=(1,), bias=False)
            (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (2): ReLU()
          )
          (1): Conv1d(64, 2, kernel_size=(1,), stride=(1,))
        )
        (heatmap): Sequential(
          (0): Sequential(
            (0): Conv1d(128, 64, kernel_size=(1,), stride=(1,), bias=False)
            (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (2): ReLU()
          )
          (1): Conv1d(64, 10, kernel_size=(1,), stride=(1,))
        )
      )
    )
    (point_head): None
    (roi_head): None
  )
)
2024-08-17 00:26:27,146   INFO  **********************Start training nuscenes_models/bevfusion(bevfusion_baseline_1_4_split_scenes)**********************
2024-08-17 00:27:01,380   INFO  **********************End training nuscenes_models/bevfusion(bevfusion_baseline_1_4_split_scenes)**********************



2024-08-17 00:27:01,381   INFO  **********************Start evaluation nuscenes_models/bevfusion(bevfusion_baseline_1_4_split_scenes)**********************
2024-08-17 00:27:01,381   INFO  Loading NuScenes dataset
2024-08-17 00:27:02,280   INFO  Total samples for NuScenes dataset: 6019
2024-08-17 00:27:02,283   INFO  ==> Loading parameters from checkpoint /home/songziying/workspace/OpenPCDet/output/nuscenes_models/bevfusion/bevfusion_baseline_1_4_split_scenes/ckpt/checkpoint_epoch_15.pth to CPU
2024-08-17 00:27:02,560   INFO  ==> Checkpoint trained from version: pcdet+0.6.0+371429e
2024-08-17 00:27:02,645   INFO  ==> Done (loaded 583/583)
2024-08-17 00:27:02,651   INFO  *************** EPOCH 15 EVALUATION *****************
2024-08-17 00:29:05,309   INFO  *************** Performance of EPOCH 15 *****************
2024-08-17 00:29:05,309   INFO  Generate label finished(sec_per_example: 0.0203 second).
2024-08-17 00:29:05,309   INFO  recall_roi_0.3: 0.000000
2024-08-17 00:29:05,309   INFO  recall_rcnn_0.3: 0.701131
2024-08-17 00:29:05,309   INFO  recall_roi_0.5: 0.000000
2024-08-17 00:29:05,309   INFO  recall_rcnn_0.5: 0.464641
2024-08-17 00:29:05,309   INFO  recall_roi_0.7: 0.000000
2024-08-17 00:29:05,309   INFO  recall_rcnn_0.7: 0.178593
2024-08-17 00:29:05,311   INFO  Average predicted number of objects(6019 samples): 200.000
2024-08-17 00:32:18,590   INFO  The predictions of NuScenes have been saved to /home/songziying/workspace/OpenPCDet/output/nuscenes_models/bevfusion/bevfusion_baseline_1_4_split_scenes/eval/eval_with_train/epoch_15/val/final_result/data/results_nusc.json
2024-08-17 00:34:49,057   INFO  ----------------Nuscene detection_cvpr_2019 results-----------------
***car error@trans, scale, orient, vel, attr | AP@0.5, 1.0, 2.0, 4.0
0.19, 0.17, 0.12, 0.43, 0.22 | 71.52, 82.74, 86.66, 88.09 | mean AP: 0.8225411511464835
***truck error@trans, scale, orient, vel, attr | AP@0.5, 1.0, 2.0, 4.0
0.44, 0.24, 0.25, 0.43, 0.25 | 19.93, 38.08, 47.73, 53.44 | mean AP: 0.3979818021447896
***construction_vehicle error@trans, scale, orient, vel, attr | AP@0.5, 1.0, 2.0, 4.0
0.83, 0.53, 1.19, 0.11, 0.29 | 0.00, 4.82, 14.63, 20.39 | mean AP: 0.09961003756244521
***bus error@trans, scale, orient, vel, attr | AP@0.5, 1.0, 2.0, 4.0
0.48, 0.29, 0.24, 1.22, 0.29 | 19.67, 43.31, 59.93, 63.99 | mean AP: 0.46724094671966665
***trailer error@trans, scale, orient, vel, attr | AP@0.5, 1.0, 2.0, 4.0
0.67, 0.28, 1.01, 0.59, 0.28 | 1.64, 14.67, 25.96, 34.62 | mean AP: 0.19219065680699907
***barrier error@trans, scale, orient, vel, attr | AP@0.5, 1.0, 2.0, 4.0
0.27, 0.32, 0.14, nan, nan | 45.20, 61.75, 68.64, 70.69 | mean AP: 0.6157053335129099
***motorcycle error@trans, scale, orient, vel, attr | AP@0.5, 1.0, 2.0, 4.0
0.26, 0.27, 0.80, 0.88, 0.23 | 38.41, 52.19, 54.07, 55.81 | mean AP: 0.5011970135061318
***bicycle error@trans, scale, orient, vel, attr | AP@0.5, 1.0, 2.0, 4.0
0.24, 0.32, 0.88, 0.43, 0.02 | 12.67, 15.18, 15.45, 16.02 | mean AP: 0.14829860809994272
***pedestrian error@trans, scale, orient, vel, attr | AP@0.5, 1.0, 2.0, 4.0
0.16, 0.30, 0.52, 0.35, 0.12 | 74.93, 76.82, 78.38, 80.02 | mean AP: 0.7753648925481372
***traffic_cone error@trans, scale, orient, vel, attr | AP@0.5, 1.0, 2.0, 4.0
0.16, 0.39, nan, nan, nan | 62.50, 64.10, 67.03, 71.85 | mean AP: 0.6636978124985875
--------------average performance-------------
trans_err:	 0.3712
scale_err:	 0.3122
orient_err:	 0.5740
vel_err:	 0.5556
attr_err:	 0.2116
mAP:	 0.4684
NDS:	 0.5317

2024-08-17 00:34:49,058   INFO  Result is saved to /home/songziying/workspace/OpenPCDet/output/nuscenes_models/bevfusion/bevfusion_baseline_1_4_split_scenes/eval/eval_with_train/epoch_15/val
2024-08-17 00:34:49,058   INFO  ****************Evaluation done.*****************
2024-08-17 00:34:49,086   INFO  Epoch 15 has been evaluated
2024-08-17 00:34:49,087   INFO  ==> Loading parameters from checkpoint /home/songziying/workspace/OpenPCDet/output/nuscenes_models/bevfusion/bevfusion_baseline_1_4_split_scenes/ckpt/checkpoint_epoch_16.pth to CPU
2024-08-17 00:34:49,337   INFO  ==> Checkpoint trained from version: pcdet+0.6.0+371429e
2024-08-17 00:34:49,416   INFO  ==> Done (loaded 583/583)
2024-08-17 00:34:49,438   INFO  *************** EPOCH 16 EVALUATION *****************
2024-08-17 00:36:47,412   INFO  *************** Performance of EPOCH 16 *****************
2024-08-17 00:36:47,413   INFO  Generate label finished(sec_per_example: 0.0196 second).
2024-08-17 00:36:47,413   INFO  recall_roi_0.3: 0.000000
2024-08-17 00:36:47,413   INFO  recall_rcnn_0.3: 0.680899
2024-08-17 00:36:47,413   INFO  recall_roi_0.5: 0.000000
2024-08-17 00:36:47,413   INFO  recall_rcnn_0.5: 0.442865
2024-08-17 00:36:47,413   INFO  recall_roi_0.7: 0.000000
2024-08-17 00:36:47,413   INFO  recall_rcnn_0.7: 0.167916
2024-08-17 00:36:47,416   INFO  Average predicted number of objects(6019 samples): 200.000
2024-08-17 00:40:06,728   INFO  The predictions of NuScenes have been saved to /home/songziying/workspace/OpenPCDet/output/nuscenes_models/bevfusion/bevfusion_baseline_1_4_split_scenes/eval/eval_with_train/epoch_16/val/final_result/data/results_nusc.json
2024-08-17 00:42:37,094   INFO  ----------------Nuscene detection_cvpr_2019 results-----------------
***car error@trans, scale, orient, vel, attr | AP@0.5, 1.0, 2.0, 4.0
0.20, 0.18, 0.13, 0.45, 0.21 | 70.58, 82.46, 86.36, 87.76 | mean AP: 0.8179177995633204
***truck error@trans, scale, orient, vel, attr | AP@0.5, 1.0, 2.0, 4.0
0.43, 0.25, 0.22, 0.43, 0.26 | 21.31, 40.65, 50.19, 55.71 | mean AP: 0.41969676020989516
***construction_vehicle error@trans, scale, orient, vel, attr | AP@0.5, 1.0, 2.0, 4.0
0.82, 0.51, 1.19, 0.12, 0.29 | 0.00, 4.97, 14.28, 21.52 | mean AP: 0.10193278462532603
***bus error@trans, scale, orient, vel, attr | AP@0.5, 1.0, 2.0, 4.0
0.49, 0.31, 0.24, 1.14, 0.30 | 17.29, 44.93, 59.22, 64.14 | mean AP: 0.46395549907818634
***trailer error@trans, scale, orient, vel, attr | AP@0.5, 1.0, 2.0, 4.0
0.64, 0.29, 1.08, 0.61, 0.26 | 3.36, 13.23, 27.05, 38.80 | mean AP: 0.20610978352748613
***barrier error@trans, scale, orient, vel, attr | AP@0.5, 1.0, 2.0, 4.0
0.28, 0.33, 0.16, nan, nan | 45.40, 62.18, 69.20, 71.53 | mean AP: 0.6207557678174819
***motorcycle error@trans, scale, orient, vel, attr | AP@0.5, 1.0, 2.0, 4.0
0.26, 0.28, 0.86, 0.85, 0.23 | 41.25, 53.06, 54.93, 56.41 | mean AP: 0.5141343192225005
***bicycle error@trans, scale, orient, vel, attr | AP@0.5, 1.0, 2.0, 4.0
0.23, 0.34, 0.77, 0.47, 0.02 | 13.29, 15.81, 16.00, 16.85 | mean AP: 0.15488835751639515
***pedestrian error@trans, scale, orient, vel, attr | AP@0.5, 1.0, 2.0, 4.0
0.16, 0.30, 0.52, 0.36, 0.12 | 73.26, 75.10, 76.60, 78.28 | mean AP: 0.7580885276736842
***traffic_cone error@trans, scale, orient, vel, attr | AP@0.5, 1.0, 2.0, 4.0
0.17, 0.39, nan, nan, nan | 60.64, 62.54, 65.45, 69.99 | mean AP: 0.6465591201988596
--------------average performance-------------
trans_err:	 0.3666
scale_err:	 0.3183
orient_err:	 0.5750
vel_err:	 0.5537
attr_err:	 0.2122
mAP:	 0.4704
NDS:	 0.5326

2024-08-17 00:42:37,095   INFO  Result is saved to /home/songziying/workspace/OpenPCDet/output/nuscenes_models/bevfusion/bevfusion_baseline_1_4_split_scenes/eval/eval_with_train/epoch_16/val
2024-08-17 00:42:37,095   INFO  ****************Evaluation done.*****************
2024-08-17 00:42:37,121   INFO  Epoch 16 has been evaluated
2024-08-17 00:42:37,122   INFO  ==> Loading parameters from checkpoint /home/songziying/workspace/OpenPCDet/output/nuscenes_models/bevfusion/bevfusion_baseline_1_4_split_scenes/ckpt/checkpoint_epoch_17.pth to CPU
2024-08-17 00:42:37,375   INFO  ==> Checkpoint trained from version: pcdet+0.6.0+371429e
2024-08-17 00:42:37,454   INFO  ==> Done (loaded 583/583)
2024-08-17 00:42:37,482   INFO  *************** EPOCH 17 EVALUATION *****************
2024-08-17 00:44:34,936   INFO  *************** Performance of EPOCH 17 *****************
2024-08-17 00:44:34,936   INFO  Generate label finished(sec_per_example: 0.0195 second).
2024-08-17 00:44:34,936   INFO  recall_roi_0.3: 0.000000
2024-08-17 00:44:34,936   INFO  recall_rcnn_0.3: 0.719278
2024-08-17 00:44:34,936   INFO  recall_roi_0.5: 0.000000
2024-08-17 00:44:34,936   INFO  recall_rcnn_0.5: 0.491047
2024-08-17 00:44:34,936   INFO  recall_roi_0.7: 0.000000
2024-08-17 00:44:34,937   INFO  recall_rcnn_0.7: 0.195752
2024-08-17 00:44:34,939   INFO  Average predicted number of objects(6019 samples): 200.000
2024-08-17 00:47:56,523   INFO  The predictions of NuScenes have been saved to /home/songziying/workspace/OpenPCDet/output/nuscenes_models/bevfusion/bevfusion_baseline_1_4_split_scenes/eval/eval_with_train/epoch_17/val/final_result/data/results_nusc.json
2024-08-17 00:50:25,338   INFO  ----------------Nuscene detection_cvpr_2019 results-----------------
***car error@trans, scale, orient, vel, attr | AP@0.5, 1.0, 2.0, 4.0
0.19, 0.16, 0.11, 0.40, 0.21 | 72.93, 83.87, 87.83, 89.18 | mean AP: 0.8345238960606068
***truck error@trans, scale, orient, vel, attr | AP@0.5, 1.0, 2.0, 4.0
0.43, 0.23, 0.22, 0.39, 0.26 | 22.25, 41.21, 50.99, 56.04 | mean AP: 0.42624605109034663
***construction_vehicle error@trans, scale, orient, vel, attr | AP@0.5, 1.0, 2.0, 4.0
0.86, 0.52, 1.22, 0.11, 0.31 | 0.00, 4.70, 17.46, 24.11 | mean AP: 0.11565654856196086
***bus error@trans, scale, orient, vel, attr | AP@0.5, 1.0, 2.0, 4.0
0.47, 0.25, 0.24, 1.06, 0.32 | 19.08, 47.89, 61.93, 67.57 | mean AP: 0.49117941399428033
***trailer error@trans, scale, orient, vel, attr | AP@0.5, 1.0, 2.0, 4.0
0.65, 0.26, 1.03, 0.63, 0.26 | 2.80, 15.77, 28.54, 40.08 | mean AP: 0.21800396416124512
***barrier error@trans, scale, orient, vel, attr | AP@0.5, 1.0, 2.0, 4.0
0.27, 0.32, 0.13, nan, nan | 47.57, 64.12, 71.13, 73.42 | mean AP: 0.6405972756489363
***motorcycle error@trans, scale, orient, vel, attr | AP@0.5, 1.0, 2.0, 4.0
0.26, 0.27, 0.79, 0.76, 0.22 | 40.19, 53.68, 55.72, 57.25 | mean AP: 0.5170979788221525
***bicycle error@trans, scale, orient, vel, attr | AP@0.5, 1.0, 2.0, 4.0
0.23, 0.31, 0.86, 0.38, 0.03 | 14.31, 16.80, 16.92, 17.56 | mean AP: 0.16398931074943815
***pedestrian error@trans, scale, orient, vel, attr | AP@0.5, 1.0, 2.0, 4.0
0.16, 0.29, 0.49, 0.33, 0.10 | 75.86, 77.69, 79.23, 80.93 | mean AP: 0.7843032122448894
***traffic_cone error@trans, scale, orient, vel, attr | AP@0.5, 1.0, 2.0, 4.0
0.16, 0.39, nan, nan, nan | 62.40, 64.07, 67.08, 71.61 | mean AP: 0.6628875426808853
--------------average performance-------------
trans_err:	 0.3669
scale_err:	 0.3020
orient_err:	 0.5652
vel_err:	 0.5086
attr_err:	 0.2127
mAP:	 0.4854
NDS:	 0.5472

2024-08-17 00:50:25,339   INFO  Result is saved to /home/songziying/workspace/OpenPCDet/output/nuscenes_models/bevfusion/bevfusion_baseline_1_4_split_scenes/eval/eval_with_train/epoch_17/val
2024-08-17 00:50:25,339   INFO  ****************Evaluation done.*****************
2024-08-17 00:50:25,366   INFO  Epoch 17 has been evaluated
2024-08-17 00:50:25,368   INFO  ==> Loading parameters from checkpoint /home/songziying/workspace/OpenPCDet/output/nuscenes_models/bevfusion/bevfusion_baseline_1_4_split_scenes/ckpt/checkpoint_epoch_18.pth to CPU
2024-08-17 00:50:25,623   INFO  ==> Checkpoint trained from version: pcdet+0.6.0+371429e
2024-08-17 00:50:25,701   INFO  ==> Done (loaded 583/583)
2024-08-17 00:50:25,730   INFO  *************** EPOCH 18 EVALUATION *****************
2024-08-17 00:52:26,919   INFO  *************** Performance of EPOCH 18 *****************
2024-08-17 00:52:26,919   INFO  Generate label finished(sec_per_example: 0.0201 second).
2024-08-17 00:52:26,919   INFO  recall_roi_0.3: 0.000000
2024-08-17 00:52:26,919   INFO  recall_rcnn_0.3: 0.717875
2024-08-17 00:52:26,919   INFO  recall_roi_0.5: 0.000000
2024-08-17 00:52:26,919   INFO  recall_rcnn_0.5: 0.489697
2024-08-17 00:52:26,919   INFO  recall_roi_0.7: 0.000000
2024-08-17 00:52:26,919   INFO  recall_rcnn_0.7: 0.194175
2024-08-17 00:52:26,922   INFO  Average predicted number of objects(6019 samples): 200.000
2024-08-17 00:55:49,724   INFO  The predictions of NuScenes have been saved to /home/songziying/workspace/OpenPCDet/output/nuscenes_models/bevfusion/bevfusion_baseline_1_4_split_scenes/eval/eval_with_train/epoch_18/val/final_result/data/results_nusc.json
2024-08-17 00:58:21,286   INFO  ----------------Nuscene detection_cvpr_2019 results-----------------
***car error@trans, scale, orient, vel, attr | AP@0.5, 1.0, 2.0, 4.0
0.19, 0.16, 0.11, 0.38, 0.21 | 72.98, 83.99, 87.85, 89.19 | mean AP: 0.8350364974607276
***truck error@trans, scale, orient, vel, attr | AP@0.5, 1.0, 2.0, 4.0
0.43, 0.23, 0.21, 0.40, 0.26 | 22.08, 40.78, 51.06, 56.50 | mean AP: 0.4260607766501029
***construction_vehicle error@trans, scale, orient, vel, attr | AP@0.5, 1.0, 2.0, 4.0
0.82, 0.52, 1.20, 0.11, 0.30 | 0.00, 5.85, 16.97, 24.09 | mean AP: 0.11727776803134549
***bus error@trans, scale, orient, vel, attr | AP@0.5, 1.0, 2.0, 4.0
0.46, 0.25, 0.22, 1.03, 0.31 | 20.42, 47.87, 63.26, 67.69 | mean AP: 0.4981102979145279
***trailer error@trans, scale, orient, vel, attr | AP@0.5, 1.0, 2.0, 4.0
0.61, 0.27, 1.07, 0.68, 0.28 | 3.66, 17.00, 28.88, 38.62 | mean AP: 0.22041335311614638
***barrier error@trans, scale, orient, vel, attr | AP@0.5, 1.0, 2.0, 4.0
0.27, 0.32, 0.14, nan, nan | 47.23, 63.25, 70.54, 72.52 | mean AP: 0.6338497505953653
***motorcycle error@trans, scale, orient, vel, attr | AP@0.5, 1.0, 2.0, 4.0
0.25, 0.27, 0.82, 0.72, 0.23 | 41.42, 54.56, 56.46, 58.22 | mean AP: 0.5266417227819878
***bicycle error@trans, scale, orient, vel, attr | AP@0.5, 1.0, 2.0, 4.0
0.24, 0.30, 0.87, 0.39, 0.03 | 15.09, 17.47, 17.70, 18.31 | mean AP: 0.17142952522921892
***pedestrian error@trans, scale, orient, vel, attr | AP@0.5, 1.0, 2.0, 4.0
0.16, 0.30, 0.47, 0.33, 0.10 | 75.73, 77.52, 78.98, 80.63 | mean AP: 0.7821417382442086
***traffic_cone error@trans, scale, orient, vel, attr | AP@0.5, 1.0, 2.0, 4.0
0.16, 0.39, nan, nan, nan | 62.35, 64.08, 67.12, 71.71 | mean AP: 0.6631378835452235
--------------average performance-------------
trans_err:	 0.3602
scale_err:	 0.3023
orient_err:	 0.5673
vel_err:	 0.5046
attr_err:	 0.2150
mAP:	 0.4874
NDS:	 0.5488

2024-08-17 00:58:21,287   INFO  Result is saved to /home/songziying/workspace/OpenPCDet/output/nuscenes_models/bevfusion/bevfusion_baseline_1_4_split_scenes/eval/eval_with_train/epoch_18/val
2024-08-17 00:58:21,287   INFO  ****************Evaluation done.*****************
2024-08-17 00:58:21,315   INFO  Epoch 18 has been evaluated
2024-08-17 00:58:21,317   INFO  ==> Loading parameters from checkpoint /home/songziying/workspace/OpenPCDet/output/nuscenes_models/bevfusion/bevfusion_baseline_1_4_split_scenes/ckpt/checkpoint_epoch_19.pth to CPU
2024-08-17 00:58:21,574   INFO  ==> Checkpoint trained from version: pcdet+0.6.0+371429e
2024-08-17 00:58:21,651   INFO  ==> Done (loaded 583/583)
2024-08-17 00:58:21,656   INFO  *************** EPOCH 19 EVALUATION *****************
2024-08-17 01:00:20,454   INFO  *************** Performance of EPOCH 19 *****************
2024-08-17 01:00:20,454   INFO  Generate label finished(sec_per_example: 0.0197 second).
2024-08-17 01:00:20,454   INFO  recall_roi_0.3: 0.000000
2024-08-17 01:00:20,454   INFO  recall_rcnn_0.3: 0.720788
2024-08-17 01:00:20,454   INFO  recall_roi_0.5: 0.000000
2024-08-17 01:00:20,454   INFO  recall_rcnn_0.5: 0.493940
2024-08-17 01:00:20,454   INFO  recall_roi_0.7: 0.000000
2024-08-17 01:00:20,454   INFO  recall_rcnn_0.7: 0.194202
2024-08-17 01:00:20,457   INFO  Average predicted number of objects(6019 samples): 200.000
2024-08-17 01:03:37,829   INFO  The predictions of NuScenes have been saved to /home/songziying/workspace/OpenPCDet/output/nuscenes_models/bevfusion/bevfusion_baseline_1_4_split_scenes/eval/eval_with_train/epoch_19/val/final_result/data/results_nusc.json
2024-08-17 01:06:08,511   INFO  ----------------Nuscene detection_cvpr_2019 results-----------------
***car error@trans, scale, orient, vel, attr | AP@0.5, 1.0, 2.0, 4.0
0.19, 0.16, 0.11, 0.38, 0.21 | 73.10, 84.01, 87.86, 89.18 | mean AP: 0.8353696078833324
***truck error@trans, scale, orient, vel, attr | AP@0.5, 1.0, 2.0, 4.0
0.43, 0.23, 0.21, 0.39, 0.26 | 21.93, 40.94, 51.15, 56.68 | mean AP: 0.4267186416237999
***construction_vehicle error@trans, scale, orient, vel, attr | AP@0.5, 1.0, 2.0, 4.0
0.83, 0.51, 1.21, 0.12, 0.31 | 0.00, 6.06, 18.01, 25.44 | mean AP: 0.12377802467128757
***bus error@trans, scale, orient, vel, attr | AP@0.5, 1.0, 2.0, 4.0
0.46, 0.25, 0.22, 1.01, 0.31 | 20.53, 48.60, 63.10, 67.66 | mean AP: 0.4997291121680512
***trailer error@trans, scale, orient, vel, attr | AP@0.5, 1.0, 2.0, 4.0
0.66, 0.26, 1.07, 0.63, 0.24 | 1.76, 15.51, 28.04, 38.66 | mean AP: 0.2099236133250752
***barrier error@trans, scale, orient, vel, attr | AP@0.5, 1.0, 2.0, 4.0
0.26, 0.32, 0.14, nan, nan | 47.31, 63.21, 70.38, 72.30 | mean AP: 0.6330007461322421
***motorcycle error@trans, scale, orient, vel, attr | AP@0.5, 1.0, 2.0, 4.0
0.25, 0.27, 0.81, 0.73, 0.23 | 40.64, 53.80, 55.83, 57.47 | mean AP: 0.519343880745787
***bicycle error@trans, scale, orient, vel, attr | AP@0.5, 1.0, 2.0, 4.0
0.24, 0.30, 0.86, 0.40, 0.03 | 14.30, 16.89, 17.05, 17.69 | mean AP: 0.16483673925421377
***pedestrian error@trans, scale, orient, vel, attr | AP@0.5, 1.0, 2.0, 4.0
0.16, 0.30, 0.48, 0.33, 0.11 | 75.82, 77.55, 79.11, 80.76 | mean AP: 0.7831152430040103
***traffic_cone error@trans, scale, orient, vel, attr | AP@0.5, 1.0, 2.0, 4.0
0.17, 0.38, nan, nan, nan | 61.96, 63.79, 66.85, 71.47 | mean AP: 0.6601577657175799
--------------average performance-------------
trans_err:	 0.3655
scale_err:	 0.3002
orient_err:	 0.5687
vel_err:	 0.4972
attr_err:	 0.2125
mAP:	 0.4856
NDS:	 0.5484

2024-08-17 01:06:08,512   INFO  Result is saved to /home/songziying/workspace/OpenPCDet/output/nuscenes_models/bevfusion/bevfusion_baseline_1_4_split_scenes/eval/eval_with_train/epoch_19/val
2024-08-17 01:06:08,512   INFO  ****************Evaluation done.*****************
2024-08-17 01:06:08,540   INFO  Epoch 19 has been evaluated
2024-08-17 01:06:08,541   INFO  ==> Loading parameters from checkpoint /home/songziying/workspace/OpenPCDet/output/nuscenes_models/bevfusion/bevfusion_baseline_1_4_split_scenes/ckpt/checkpoint_epoch_20.pth to CPU
2024-08-17 01:06:08,788   INFO  ==> Checkpoint trained from version: pcdet+0.6.0+371429e
2024-08-17 01:06:08,866   INFO  ==> Done (loaded 583/583)
2024-08-17 01:06:08,871   INFO  *************** EPOCH 20 EVALUATION *****************
2024-08-17 01:08:09,683   INFO  *************** Performance of EPOCH 20 *****************
2024-08-17 01:08:09,684   INFO  Generate label finished(sec_per_example: 0.0201 second).
2024-08-17 01:08:09,684   INFO  recall_roi_0.3: 0.000000
2024-08-17 01:08:09,684   INFO  recall_rcnn_0.3: 0.714166
2024-08-17 01:08:09,684   INFO  recall_roi_0.5: 0.000000
2024-08-17 01:08:09,684   INFO  recall_rcnn_0.5: 0.483951
2024-08-17 01:08:09,684   INFO  recall_roi_0.7: 0.000000
2024-08-17 01:08:09,684   INFO  recall_rcnn_0.7: 0.185242
2024-08-17 01:08:09,686   INFO  Average predicted number of objects(6019 samples): 200.000
2024-08-17 01:11:29,694   INFO  The predictions of NuScenes have been saved to /home/songziying/workspace/OpenPCDet/output/nuscenes_models/bevfusion/bevfusion_baseline_1_4_split_scenes/eval/eval_with_train/epoch_20/val/final_result/data/results_nusc.json
2024-08-17 01:14:01,557   INFO  ----------------Nuscene detection_cvpr_2019 results-----------------
***car error@trans, scale, orient, vel, attr | AP@0.5, 1.0, 2.0, 4.0
0.19, 0.16, 0.11, 0.39, 0.20 | 73.02, 83.92, 87.73, 89.06 | mean AP: 0.8343225403760981
***truck error@trans, scale, orient, vel, attr | AP@0.5, 1.0, 2.0, 4.0
0.43, 0.23, 0.20, 0.38, 0.26 | 22.12, 40.16, 50.55, 56.22 | mean AP: 0.4226290966637985
***construction_vehicle error@trans, scale, orient, vel, attr | AP@0.5, 1.0, 2.0, 4.0
0.83, 0.51, 1.19, 0.12, 0.31 | 0.00, 5.80, 16.59, 24.05 | mean AP: 0.11609156682964397
***bus error@trans, scale, orient, vel, attr | AP@0.5, 1.0, 2.0, 4.0
0.46, 0.26, 0.22, 1.02, 0.31 | 20.16, 48.18, 63.03, 67.30 | mean AP: 0.4966673094609818
***trailer error@trans, scale, orient, vel, attr | AP@0.5, 1.0, 2.0, 4.0
0.66, 0.27, 1.08, 0.66, 0.27 | 1.65, 15.49, 28.05, 38.36 | mean AP: 0.2088656381537362
***barrier error@trans, scale, orient, vel, attr | AP@0.5, 1.0, 2.0, 4.0
0.26, 0.32, 0.14, nan, nan | 46.86, 63.06, 69.93, 72.22 | mean AP: 0.6301692052573021
***motorcycle error@trans, scale, orient, vel, attr | AP@0.5, 1.0, 2.0, 4.0
0.25, 0.27, 0.80, 0.75, 0.23 | 40.58, 53.61, 55.62, 57.27 | mean AP: 0.517693586711165
***bicycle error@trans, scale, orient, vel, attr | AP@0.5, 1.0, 2.0, 4.0
0.24, 0.30, 0.85, 0.40, 0.03 | 14.18, 16.90, 17.12, 17.75 | mean AP: 0.16488670737702993
***pedestrian error@trans, scale, orient, vel, attr | AP@0.5, 1.0, 2.0, 4.0
0.16, 0.30, 0.48, 0.33, 0.11 | 76.03, 77.76, 79.27, 80.95 | mean AP: 0.785011459900101
***traffic_cone error@trans, scale, orient, vel, attr | AP@0.5, 1.0, 2.0, 4.0
0.16, 0.38, nan, nan, nan | 62.24, 63.97, 66.94, 71.57 | mean AP: 0.6618049343092892
--------------average performance-------------
trans_err:	 0.3643
scale_err:	 0.3015
orient_err:	 0.5643
vel_err:	 0.5060
attr_err:	 0.2145
mAP:	 0.4838
NDS:	 0.5469

2024-08-17 01:14:01,558   INFO  Result is saved to /home/songziying/workspace/OpenPCDet/output/nuscenes_models/bevfusion/bevfusion_baseline_1_4_split_scenes/eval/eval_with_train/epoch_20/val
2024-08-17 01:14:01,558   INFO  ****************Evaluation done.*****************
2024-08-17 01:14:01,587   INFO  Epoch 20 has been evaluated
2024-08-17 01:14:31,619   INFO  **********************End evaluation nuscenes_models/bevfusion(bevfusion_baseline_1_4_split_scenes)**********************
